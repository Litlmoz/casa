flats_list = [
 [215103,0,1,"11",12,754,true,"2015-12-30 16:40:47.579121",3815,"2017-02-12 11:40:33.712068"],[215075,0,1,"41",5,476,true,"2015-11-03 11:41:09.610167",3195,"2017-02-13 08:40:36.397829"],[215075,0,1,"27",21,476,true,"2015-11-02 03:40:50.94797",3365,"2017-02-13 08:40:36.447905"],[215075,0,1,"42",5,476,true,"2017-01-18 03:41:31.586609",3245,"2017-02-13 08:40:36.475256"],[215075,0,1,"29",19,476,true,"2017-02-04 08:40:22.747082",3540,"2017-02-13 08:40:36.490293"],[215075,0,1,"27",5,476,true,"2017-01-26 01:40:57.236558",3175,"2017-02-13 08:40:36.504526"],[215079,0,1,"16",5,471,true,"2017-02-07 03:40:32.778494",3590,"2017-02-13 08:40:36.518741"],[215089,0,1,"31",19,470,true,"2016-03-16 09:40:57.517865",3390,"2017-02-13 08:40:36.556291"],[215089,0,1,"31",22,470,true,"2015-12-22 11:40:40.62079",3390,"2017-02-13 08:40:36.575513"],[215089,0,1,"31",20,470,false,"2017-02-01 03:40:58.820322",3350,"2017-02-13 08:40:36.593311"],[215091,0,1,"23",4,604,true,"2015-11-01 00:29:21.540865",3525,"2017-02-13 08:40:36.607095"],[215091,0,1,"23",12,604,true,"2015-11-01 00:29:21.740366",3650,"2017-02-13 08:40:36.630234"],[215091,0,1,"23",16,604,true,"2017-02-07 03:40:32.895791",3575,"2017-02-13 08:40:36.652654"],[215093,0,1,"24",5,583,true,"2016-12-05 00:51:00.049607",3555,"2017-02-13 08:40:36.666658"],[215093,0,1,"24",6,583,false,"2015-12-01 11:41:06.622229",3550,"2017-02-13 08:40:36.680043"],[215093,0,1,"24",20,583,true,"2017-01-31 03:40:34.379086",3620,"2017-02-13 08:40:36.697389"],[215103,0,1,"11",14,754,true,"2017-01-28 03:40:44.853215",3945,"2017-02-13 08:40:36.717326"],[215103,0,1,"11",12,754,true,"2015-12-30 16:40:47.579121",3825,"2017-02-13 08:40:36.731375"],[215075,0,1,"28",8,476,true,"2016-12-20 03:27:54.053744",3135,"2017-02-14 08:41:00.715506"],[215075,0,1,"27",5,476,true,"2017-01-26 01:40:57.236558",3180,"2017-02-14 08:41:00.752346"],[215075,0,1,"41",5,476,true,"2015-11-03 11:41:09.610167",3200,"2017-02-14 08:41:00.771044"],[215075,0,1,"27",18,476,true,"2015-11-01 00:29:21.840297",3520,"2017-02-14 08:41:00.791784"],[215075,0,1,"29",19,476,true,"2017-02-04 08:40:22.747082",3545,"2017-02-14 08:41:00.81189"],[215075,0,1,"29",10,476,true,"2016-12-05 03:41:05.452648",3575,"2017-02-14 08:41:00.849384"],[215079,0,1,"19",8,471,true,"2016-12-05 00:50:59.768672",3495,"2017-02-14 08:41:00.869267"],[215081,0,1,"44",3,474,true,"2016-12-05 00:50:59.840799",3330,"2017-02-14 08:41:00.903543"],[215089,0,1,"31",20,470,false,"2017-02-01 03:40:58.820322",3355,"2017-02-14 08:41:00.920855"],[215093,0,1,"24",6,583,false,"2015-12-01 11:41:06.622229",3545,"2017-02-14 08:41:01.014119"],[215093,0,1,"24",5,583,true,"2016-12-05 00:51:00.049607",3550,"2017-02-14 08:41:01.046876"],[215103,0,1,"11",14,754,true,"2017-01-28 03:40:44.853215",3940,"2017-02-14 08:41:01.099641"],[215075,0,1,"42",5,476,true,"2017-01-18 03:41:31.586609",3250,"2017-02-15 08:40:27.153843"],[215079,0,1,"16",5,471,true,"2017-02-07 03:40:32.778494",3595,"2017-02-15 08:40:27.185744"],[215091,0,1,"23",16,604,true,"2017-02-07 03:40:32.895791",3585,"2017-02-15 08:40:27.26026"],[215091,0,1,"23",4,604,true,"2015-11-01 00:29:21.540865",3540,"2017-02-15 08:40:27.278346"],[215091,0,1,"23",12,604,true,"2015-11-01 00:29:21.740366",3655,"2017-02-15 08:40:27.295963"],[215093,0,1,"24",20,583,true,"2017-01-31 03:40:34.379086",3630,"2017-02-15 08:40:27.322401"],[215093,0,1,"24",5,583,true,"2016-12-05 00:51:00.049607",3560,"2017-02-15 08:40:27.340646"],[215103,0,1,"11",12,754,true,"2015-12-30 16:40:47.579121",3835,"2017-02-15 08:40:27.36079"],[215103,0,1,"11",14,754,true,"2017-01-28 03:40:44.853215",3950,"2017-02-15 08:40:27.377463"]
]

flats_list.each do |floorplan_identifier, bed, bath, stack, floor, sqft, is_active, flat_created_at, price, listing_created_at|
  flat = Flat.find_or_create_by!(bed: bed, bath: bath, stack: stack, floor: floor, sqft: sqft, is_active: is_active, created_at: flat_created_at)

  unless floorplan_identifier.nil?
    floorplan = Floorplan.find_or_create_by!(layout_id: floorplan_identifier)
    flat.update! floorplan: floorplan
  end

  Listing.find_or_create_by!(flat: flat, price: price, created_at: listing_created_at)
end
